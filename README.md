# Donor lifetimes and values for a non-profit
The objective of this work is to quantify the factors in influencing donor retention for a major South-Bay non-profit.  I stratified the data and applied a patient survival model to predict the lifetimes and the hazards that will surface at different points of a donor's life.  Then I calculated the Donor Lifetime Valuefor each donor based on predicted lifetime, cost, and donation history.  This allows the non-profit to make donor retention decisions based on data and analytics, not on instincts.

Overview
========
Background
----------

- Only 20% of revenue of an average non-profit comes from donations (most of the rest of government contacts)
- There is often no-coherent strategy for recruiting or retaining donors.  Traditional methods range from holding expensive special events to personal connections.  Often this is done by hunches and without any analytical support.
- Questions to be answered:
	1.  What are the good predictors of donor lifetimes?
	2.  How to extend donor lifetimes?

Data
----
- Donor database from South Bay non-profit. 2338 donors spanning over 40 years.
- 100 features.  Examples: ZIP code, martial status, gender...


Modeling
========
Approach
--------
- The Aalen Additive model, which is patient-survival model, was used to predict the lifetime. The model fits the data to a "hazard function" in turn is used to predict the lifetime.

- The hazard function are features which can influence the lifetime of the patient, which is the donor in our use case.

	Î»(t) = b<sub>0</sub>(t) + b<sub>1</sub>(t)x<sub>1</sub> +. . . +b<sub>N</sub>(t)x<sub>T</sub>


- Why not a multi-decision tree model?  Because a patient-survival model is more interpretable.

- Why not linear or logistic regression?  Because the residuals are not uniform over time.

Data processing
---------------
- Data package "Lifelines" which contains the Aalen additive model

Bootstrapping
-------------
- The more than 100 features were whittled down to 76 based on the p values.  (Details not repeated here).  
	1.	ACGC (whether a donor comes from the ACGC branch of the organization)
	2.	COS breakfast (A $100/plate breakfast event with a celebrity speaker)
	3.	Golf tournament (A golf tournament held at a country club that cost $1000 to play)
	4.	Male (True = male, False = female)
	5.	Married (True = married or partnered, False = single, divorced, widowed)
	6. 	Personal connection (True =  a personal friend or acquaintance of an employee of the agency.)
	7.  Predicted income (Using the zip code, we scrapped the US census website for the average household income and use this as the feature.)
- Because of the relative small data set, a bootstrap approach was used to model the data.   Samples were drawn with replacement from the original data set 10 000 times to train 10 000 models.  These 10 000 models generated 10 000 hazard functions.  

Results
=======
Hazards
-------
The plots below show the hazard functions generated by the bootstrapped models.  The variance of our model is nicely approximated by the spread of lines.   
-  The baseline hazard function represents all the hazards not accounted for by the hazards.  That is, it is the hazard function if all the categorical features were false and all the numerical features were at their average values.  

<img src="images/cum_haz_baseline.png>

- The hazard function for each hazard were plotted below. Each function shows at what time in a donor's lifetime hazard will emerge.  Note that even though these functions are called "hazards," when they are negative, they are actually "benefits" that prolong the lifetime of the donor.  For example, a higher than average income would produce a negative hazard over much of the lifetime of a donor.

<img src="images/cum_haz_ACGC.png>
<img src="images/cum_haz_COS.png>
<img src="images/cum_haz_golf.png>
<img src="images/cum_haz_male.png>
<img src="images/cum_haz_married.png>
<img src="images/cum_haz_personal_connection.png>
<img src="images/cum_haz_pred_income.png>

- For any given donor (old or new), we can substitute his features into the model to predict the lifetime.  More importantly, we can customize a hazard function for each donor and predict at what times in her or his lifetime hazards will emerge (represented by steep slopes in the hazard function).  This is illustrated below by the plots of the hazard function 15 random donors, each with a different profile of features.   

<img src="images/Cum_haz_15donors.png>
